<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Punk Voyage Adventures</title>
    <!-- Xverse SDK -->
    <script src="https://unpkg.com/@xverse/wallet@0.1.1/dist/umd/index.js"></script>
    <!-- Unisat SDK -->
    <script src="https://unpkg.com/unisat-wallet@1.0.0/dist/unisat.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="game-title">PUNK VOYAGE ADVENTURES</div>
            <div class="player-info">
                PLAYER <span id="player-id">0</span>, WELCOME<br>
                <span class="pv-tokens">PV = <span id="pv-amount">0</span></span> , GOLD = <span id="gold-amount">0</span>
            </div>
            <div class="wallet-connect" id="wallet-connect">
                CONNECT WALLET
                <div class="wallet-options" id="wallet-options" style="display: none;">
                    <div class="wallet-option" data-wallet="xverse">XVERSE</div>
                    <div class="wallet-option" data-wallet="unisat">UNISAT</div>
                    <div class="wallet-option" data-wallet="magiceden">MAGIC EDEN WALLET</div>
                </div>
            </div>
        </header>
    </div>

    <script>
        // Game state
        const gameState = {
            player: {
                id: Math.floor(Math.random() * 100000),
                pv: 0,
                gold: 0,
                punks: 0,
                connected: false,
                wallet: null,
                address: null
            }
        };

        // DOM Elements
        const playerIdEl = document.getElementById('player-id');
        const pvAmountEl = document.getElementById('pv-amount');
        const goldAmountEl = document.getElementById('gold-amount');
        const walletConnectBtn = document.getElementById('wallet-connect');
        const walletOptions = document.getElementById('wallet-options');

        // Initialize game
        function initGame() {
            updateUI();

            // Wallet connect button click
            walletConnectBtn.addEventListener('click', () => {
                walletOptions.style.display = walletOptions.style.display === 'none' ? 'block' : 'none';
            });

            // Wallet options click
            document.querySelectorAll('.wallet-option').forEach(option => {
                option.addEventListener('click', () => {
                    connectWallet(option.dataset.wallet);
                    walletOptions.style.display = 'none';
                });
            });
        }

        // Update UI elements based on game state
        function updateUI() {
            playerIdEl.textContent = gameState.player.id;
            pvAmountEl.textContent = gameState.player.pv;
            goldAmountEl.textContent = gameState.player.gold;

            if (gameState.player.connected) {
                walletConnectBtn.textContent = gameState.player.wallet.toUpperCase() + ' CONNECTED';
            } else {
                walletConnectBtn.textContent = 'CONNECT WALLET';
            }
        }

        // Connect wallet function
        async function connectWallet(walletType) {
            try {
                let address = '';
                let punks = 0;

                if (walletType === 'xverse') {
                    if (typeof XverseWallet !== 'undefined') {
                        address = await XverseWallet.getAddress();
                        punks = 3; // Simulated NFTs
                    } else {
                        alert('Xverse wallet not detected. Please install the Xverse extension.');
                        window.open('https://www.xverse.app/download', '_blank');
                        return;
                    }
                } else if (walletType === 'unisat') {
                    if (typeof window.unisat !== 'undefined') {
                        const accounts = await window.unisat.requestAccounts();
                        address = accounts[0];
                        punks = 3; // Simulated NFTs
                    } else {
                        alert('Unisat wallet not detected. Please install the Unisat extension.');
                        window.open('https://unisat.io/download', '_blank');
                        return;
                    }
                } else if (walletType === 'magiceden') {
                    alert('Magic Eden wallet integration coming soon!');
                    return;
                }

                gameState.player.connected = true;
                gameState.player.wallet = walletType;
                gameState.player.address = address;
                gameState.player.punks = punks;
                gameState.player.pv = 260; // Starting balance
                gameState.player.gold = 1; // Starting gold

                updateUI();
                alert(`${walletType.toUpperCase()} wallet connected successfully!`);
            } catch (error) {
                console.error('Wallet connection error:', error);
                alert('Error connecting wallet. Please try again.');
            }
        }

        // Initialize game on page load
        window.onload = initGame;
    </script>
</body>
</html>
